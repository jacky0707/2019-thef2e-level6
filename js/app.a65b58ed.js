(function(t){function e(e){for(var o,s,i=e[0],c=e[1],l=e[2],u=0,m=[];u<i.length;u++)s=i[u],r[s]&&m.push(r[s][0]),r[s]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);d&&d(e);while(m.length)m.shift()();return n.push.apply(n,l||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],o=!0,i=1;i<a.length;i++){var c=a[i];0!==r[c]&&(o=!1)}o&&(n.splice(e--,1),t=s(s.s=a[0]))}return t}var o={},r={app:0},n=[];function s(e){if(o[e])return o[e].exports;var a=o[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=o,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(a,o,function(e){return t[e]}.bind(null,o));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/2019-thef2e-level6/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var d=c;n.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var o=a("1356"),r=a.n(o);r.a},1:function(t,e){},1356:function(t,e,a){},2:function(t,e){},3:function(t,e){},4:function(t,e){},"56d7":function(t,e,a){"use strict";a.r(e);var o=a("2b0e"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-content",[a("router-view")],1)],1)},n=[],s={name:"App",components:{},data:()=>({})},i=s,c=(a("034f"),a("2877")),l=a("6544"),d=a.n(l),u=a("7496"),m=a("a75b"),h=Object(c["a"])(i,r,n,!1,null,null,null),v=h.exports;d()(h,{VApp:u["a"],VContent:m["a"]});var p=a("f309");o["a"].use(p["a"]);var f=new p["a"]({icons:{iconfont:"mdi"}}),g=a("8c4f"),b=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-container",[o("v-row",[o("v-col",{ref:"card",staticClass:"pb-0",attrs:{cols:"7"}},[o("v-card",[o("v-img",{staticClass:"white--text",attrs:{src:a("c20d")}})],1)],1),o("v-col",{attrs:{cols:"5"}},[o("v-card",{staticClass:"overflow",attrs:{flat:"",height:t.cardHeight,color:"transparent"}},t._l(t.roomPictures,function(e,a){return o("v-col",{key:a,staticClass:"py-1"},[o("v-hover",{scopedSlots:t._u([{key:"default",fn:function(r){var n=r.hover;return[o("v-card",{staticClass:"cursor",attrs:{elevation:n?12:2}},[o("v-img",{staticClass:"white--text",attrs:{src:e,"aspect-ratio":"1.5"},on:{click:function(e){return t.getRoomInfo(a)}}})],1)]}}],null,!0)})],1)}),1)],1)],1)],1)},k=[],_={data(){return{API:"https://challenge.thef2e.com/api/thef2e2019/stage6/rooms",roomPictures:[],roomId:[],token:"T9weHM0FWMmSXz5uowwYCBqRTEkbO7aeKGbmOJytJ17e9ORZVeRWq8yK875k",cardHeight:0}},created(){this.axios.get(this.API).then(t=>{t.data.items.map(t=>{this.roomPictures.push(t.imageUrl),this.roomId.push(t.id)}),console.log(t.data),this.cardHeight=this.$refs.card.clientHeight})},methods:{getRoomInfo(t){let e=this.roomId[t];this.$router.push(`/room/${e}`)}}},D=_,w=(a("61e3"),a("b0af")),x=a("62ad"),y=a("a523"),C=a("ce87"),P=a("adda"),R=a("0fd9"),I=Object(c["a"])(D,b,k,!1,null,"21f4cf94",null),O=I.exports;d()(I,{VCard:w["a"],VCol:x["a"],VContainer:y["a"],VHover:C["a"],VImg:P["a"],VRow:R["a"]});var T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",{attrs:{cols:"7"}},[a("div",{staticClass:"headline mb-2"},[t._v(t._s(t.roomName))]),a("v-img",{attrs:{src:t.watchingPicUrl,"aspect-ratio":"1.5"}}),a("v-row",t._l(t.roomPictures,function(e,o){return a("v-col",{key:o,attrs:{cols:"3"}},[a("v-hover",{scopedSlots:t._u([{key:"default",fn:function(e){var r=e.hover;return[a("v-card",{attrs:{elevation:r?12:2,loading:t.loading}},[a("v-img",{attrs:{src:t.roomPictures[o],"aspect-ratio":"1.5"},on:{click:function(e){return t.changeWatchingPic(t.roomPictures[o])}}})],1)]}}],null,!0)})],1)}),1),a("v-card",{attrs:{color:"transparent",flat:"",loading:t.loading}},[a("v-row",{attrs:{dense:""}},[a("v-col",{staticClass:"col-sm-6 col-12"},[a("v-card",{staticClass:"font-weight-black",attrs:{color:"transparent",flat:""}},[a("v-card-text",{staticClass:"pt-0"},[t._v("Check-in time: "+t._s(t.checkInTime.from)+"~"+t._s(t.checkInTime.to))]),a("v-card-text",{staticClass:"pt-0"},[t._v("Check-out time: "+t._s(t.checkOutTime))]),a("v-card-text",{staticClass:"pt-0"},[t._v("人數限制: "+t._s(t.guestAmount.min)+"~"+t._s(t.guestAmount.max))]),a("v-card-text",{staticClass:"pt-0"},[t._v("床型: "+t._s(t.bed.join(" & ")))]),a("v-card-text",{staticClass:"pt-0"},[t._v("衛浴數量: "+t._s(t.privateBath))]),a("v-card-text",{staticClass:"pt-0"},[t._v("房間大小: "+t._s(t.footage)+" 平方米")]),a("v-card-text",{staticClass:"pt-0"},[t._v("描述: "+t._s(t.description))])],1)],1),a("v-col",{staticClass:"col-sm-6 col-12"},t._l(t.amenities,function(e,o,r){return a("v-alert",{key:r,staticClass:"mb-3 py-0",attrs:{color:t.checkType(e),dense:"",outlined:""}},[a("v-row",{attrs:{justify:"space-between"}},[a("v-col",{staticClass:"py-0 px-1"},[t._v(t._s(o))]),a("v-col",{staticClass:"py-0 px-1 col-auto"},[t._v(t._s(e?"有":"無"))])],1)],1)}),1)],1)],1)],1),a("v-col",[a("div",{staticClass:"title bold"},[t._v("Select your date of stay")]),a("v-menu",{attrs:{transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[a("v-form",{ref:"startDateForm"},[a("v-text-field",t._g({attrs:{label:"start date",readonly:"","prepend-icon":"mdi-calendar-range",rules:t.startDateRules},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}},o))],1)]}}]),model:{value:t.startMenu,callback:function(e){t.startMenu=e},expression:"startMenu"}},[a("v-date-picker",{attrs:{"no-title":"",scrollable:"","allowed-dates":t.startAllowedDate},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}},[a("div",{staticClass:"flex-grow-1"})])],1),a("v-menu",{attrs:{transition:"scale-transition","offset-y":"","min-width":"290px"},scopedSlots:t._u([{key:"activator",fn:function(e){var o=e.on;return[a("v-form",{ref:"dateForm"},[a("v-text-field",t._g({attrs:{label:"end date",readonly:"","prepend-icon":"mdi-calendar-range",rules:t.endDateRules},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}},o))],1)]}}]),model:{value:t.endMenu,callback:function(e){t.endMenu=e},expression:"endMenu"}},[a("v-date-picker",{attrs:{"no-title":"",scrollable:"","allowed-dates":t.endAllowedDate},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}},[a("div",{staticClass:"flex-grow-1"})])],1),a("v-row",{attrs:{justify:"end"}},[a("v-col",{attrs:{cols:"auto"}},[a("div",{staticClass:"pa-3 pt-0"},[t._v("\n            平日價格: NT\n            "),a("span",{staticClass:"red--text"},[t._v(t._s(t.normalDayPrice))]),t._v(" 元/晚\n          ")]),a("div",{staticClass:"pa-3 pb-4"},[t._v("假日價格: NT "+t._s(t.holidayPrice)+" 元/晚")]),a("v-btn",{staticClass:"green lighten-3",attrs:{block:""},on:{click:t.booking}},[t._v("預訂房間")]),a("v-dialog",{attrs:{"max-width":"400"},model:{value:t.bookingDialog,callback:function(e){t.bookingDialog=e},expression:"bookingDialog"}},[a("v-card",[a("v-img",{attrs:{src:t.watchingPicUrl,"aspect-ratio":"1.5"}}),t.bookingResponseShow?a("v-card",[t.bookingResponse?a("v-card",[a("v-card-title",[t._v("訂單已完成")]),a("v-card-actions",[a("v-btn",{on:{click:t.goToHomePage}},[t._v("返回首頁")])],1)],1):a("v-card",[a("v-card-title",[t._v("預定失敗")]),a("v-card-text",[t._v("失敗原因可能為:")]),a("v-card-text",[t._v("1.預定日期為 90 天後")]),a("v-card-text",[t._v("2.預定時間已被人預定")]),a("v-card-actions",[a("v-btn",{on:{click:t.goToHomePage}},[t._v("返回首頁")])],1)],1)],1):a("v-card",[a("v-card-title",{staticClass:"headline mb-2"},[t._v(t._s(t.roomName))]),a("v-card-text",[t._v("入住日期:")]),a("v-card-text",[a("u",[t._v(t._s(t.durationDates.length>4?t.startDate+"~"+t.endDate:t.durationDates.join(", ")))])]),a("v-form",{ref:"inquireForm"},[a("v-card-actions",[a("v-text-field",{attrs:{label:"姓名",rules:t.inquireRules},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),a("v-card-actions",[a("v-text-field",{attrs:{label:"電話",rules:t.inquireRules},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}})],1),a("v-card-actions",[a("v-text-field",{attrs:{label:"email",rules:t.inquireRules},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}})],1)],1),a("v-card-actions",[a("v-btn",{staticClass:"green lighten-3",attrs:{block:""},on:{click:t.bookingConfirm}},[t._v("確認預定")])],1)],1)],1)],1)],1)],1),a("v-card",{staticClass:"pb-1",attrs:{loading:t.recommendLoading}},[a("v-card-title",{staticClass:"title mt-3"},[t._v("其他推薦")]),a("v-card",{staticClass:"ma-3",on:{click:function(e){return t.getNewRoomInfo(t.firstRecommend.id)}}},[a("v-img",{attrs:{src:t.firstRecommend.imageUrl,"aspect-ratio":"1.5"}})],1),a("v-card",{staticClass:"ma-3",on:{click:function(e){return t.getNewRoomInfo(t.secondRecommend.id)}}},[a("v-img",{attrs:{src:t.secondRecommend.imageUrl,"aspect-ratio":"1.5"}})],1)],1)],1)],1)],1)},V=[],A=(a("1c46"),{data(){return{API:"https://challenge.thef2e.com/api/thef2e2019/stage6/room/",roomId:"",roomName:"",watchingPicUrl:"",roomPictures:[],checkInTime:{from:"",to:""},checkOutTime:"",description:"",guestAmount:{min:0,max:0},bed:[],privateBath:0,footage:0,amenities:{},currentDate:(new Date).toISOString().substr(0,10),startDate:"",startMenu:!1,startDateRules:[t=>t.length>0||"please input start date"],endDate:"",endMenu:!1,endDateRules:[t=>t>this.startDate||"end date should after start date."],durationDates:[],normalDayPrice:0,holidayPrice:0,recommendAPI:"https://challenge.thef2e.com/api/thef2e2019/stage6/rooms",firstRecommend:{},secondRecommend:{},loading:!1,recommendLoading:!1,bookingDialog:!1,inquireRules:[t=>t.length>0||"please input your name"],name:"",phone:"",email:"",bookingResponseShow:!1,bookingResponse:!1}},created(){this.getRoomData()},methods:{goToHomePage(){this.$router.push("/")},bookingConfirm(){this.$refs.inquireForm.validate()&&(console.log(this.durationDates),this.axios.post(this.API+this.roomId,{name:this.name,tel:this.phone,date:this.durationDates}).then(t=>{console.log(t),this.bookingResponseShow=!0,this.bookingResponse=!0}).catch(t=>{console.log(t),this.bookingResponseShow=!0,this.bookingResponse=!1}))},booking(){this.$refs.startDateForm.validate()&&this.$refs.dateForm.validate()&&(this.durationDates=[],this.getDuration(this.startDate,this.endDate,t=>{let e=t.getFullYear()+"-"+(t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1)+"-"+(t.getDate()<10?"0"+t.getDate():t.getDate());this.durationDates.push(e)}),this.bookingDialog=!0)},getDuration(t,e,a){let o=new Date(t),r=new Date(e),n=o.getTime(),s=r.getTime(),i=864e5;for(;n<s;n+=i)a(new Date(n))},getNewRoomInfo(t){this.loading=!0,this.recommendLoading=!0,this.$router.push(`/room/${t}`),this.getRoomData()},changeWatchingPic(t){this.watchingPicUrl=t},checkType(t){return 0===t||1==t?"success":"error"},startAllowedDate(t){return t>this.currentDate},endAllowedDate(t){return t>this.currentDate&&t>this.startDate},getRoomData(){this.roomId=this.$route.params.roomId,this.axios.get(this.API+this.roomId).then(t=>{let e=t.data.room[0];this.roomName=e.name,this.roomPictures=e.imageUrl,this.watchingPicUrl=this.roomPictures[0],this.checkInTime={from:e.checkInAndOut.checkInEarly,to:e.checkInAndOut.checkInLate},this.checkOutTime=e.checkInAndOut.checkOut,this.amenities=e.amenities,this.guestAmount={max:e.descriptionShort.GuestMax,min:e.descriptionShort.GuestMin},this.bed=e.descriptionShort.Bed,this.privateBath=e.descriptionShort["Private-Bath"],this.footage=e.descriptionShort.Footage,this.description=e.description,this.normalDayPrice=e.normalDayPrice,this.holidayPrice=e.holidayPrice,this.loading=!1,console.log(t.data)}),this.axios.get(this.recommendAPI).then(t=>{let e=t.data.items;for(let a=0;a<e.length;a++)if(e[a].id==this.roomId)return this.firstRecommend.imageUrl=e[(a+1)%6].imageUrl,this.firstRecommend.id=e[(a+1)%6].id,this.secondRecommend.imageUrl=e[(a+2)%6].imageUrl,this.secondRecommend.id=e[(a+2)%6].id,this.recommendLoading=!1,void this.$forceUpdate()})}}}),S=A,M=a("0798"),j=a("8336"),$=a("99d9"),U=a("2e4b"),F=a("169a"),q=a("4bd4"),H=a("e449"),B=a("8654"),N=Object(c["a"])(S,T,V,!1,null,null,null),E=N.exports;d()(N,{VAlert:M["a"],VBtn:j["a"],VCard:w["a"],VCardActions:$["a"],VCardText:$["b"],VCardTitle:$["c"],VCol:x["a"],VContainer:y["a"],VDatePicker:U["a"],VDialog:F["a"],VForm:q["a"],VHover:C["a"],VImg:P["a"],VMenu:H["a"],VRow:R["a"],VTextField:B["a"]}),o["a"].use(g["a"]);var J=new g["a"]({routes:[{path:"/",component:O},{path:"/room/:roomId",component:E}]}),W=a("bc3a"),L=a.n(W),G=a("a7fe"),K=a.n(G);o["a"].use(K.a,L.a),o["a"].config.productionTip=!1,L.a.interceptors.request.use(t=>{return t.headers.Authorization="Bearer T9weHM0FWMmSXz5uowwYCBqRTEkbO7aeKGbmOJytJ17e9ORZVeRWq8yK875k",t.headers.Accept="application/json",t},t=>{return Promise.reject(t)}),new o["a"]({router:J,vuetify:f,render:t=>t(v)}).$mount("#app")},"61e3":function(t,e,a){"use strict";var o=a("6e36"),r=a.n(o);r.a},"6e36":function(t,e,a){},c20d:function(t,e,a){t.exports=a.p+"img/desktop_img.c45dca7f.png"}});
//# sourceMappingURL=app.a65b58ed.js.map